<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The Love Hierarchy | マズローの愛の階層診断</title>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600&family=Shippori+Mincho:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-color: #F5F2EA; /* 羊皮紙のような色 */
            --text-main: #2A2A2A;
            --text-sub: #666;
            --accent: #B89B5E; /* ゴールド */
            --accent-dark: #8E753E;
            --agree: #3A8F84; /* 同意の色（緑系） */
            --disagree: #9B4F96; /* 不同意の色（紫系） */
            --card-bg: #FFFFFF;
            --shadow: 0 10px 30px rgba(184, 155, 94, 0.15);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Shippori Mincho', 'Yu Mincho', serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            min-height: 100vh;
            line-height: 1.8;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23b89b5e' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }

        /* --- 共通レイアウト --- */
        .container {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            margin-bottom: 40px;
        }

        .logo {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-main);
            text-decoration: none;
            letter-spacing: 0.05em;
        }

        .btn-text {
            background: none;
            border: none;
            font-family: 'Shippori Mincho', serif;
            color: var(--text-sub);
            cursor: pointer;
            font-size: 0.9rem;
            transition: color 0.3s;
        }
        .btn-text:hover { color: var(--accent); }

        /* --- トップページ (Homepage) --- */
        .hero-section {
            text-align: center;
            padding: 60px 0;
            animation: fadeIn 1s ease;
        }

        h1.hero-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 3.5rem;
            line-height: 1;
            margin-bottom: 10px;
            color: var(--text-main);
        }
        
        .hero-subtitle {
            font-size: 1.1rem;
            color: var(--accent);
            letter-spacing: 0.2em;
            margin-bottom: 30px;
            font-weight: bold;
        }

        .hero-desc {
            max-width: 500px;
            margin: 0 auto 50px auto;
            color: var(--text-sub);
        }

        .btn-primary {
            display: inline-block;
            background: var(--accent);
            color: #fff;
            padding: 20px 60px;
            border-radius: 50px;
            font-size: 1.2rem;
            text-decoration: none;
            transition: all 0.3s ease;
            box-shadow: 0 10px 20px rgba(184, 155, 94, 0.4);
            border: none;
            cursor: pointer;
            font-family: 'Shippori Mincho', serif;
        }
        .btn-primary:hover {
            transform: translateY(-3px);
            background: var(--accent-dark);
            box-shadow: 0 15px 30px rgba(184, 155, 94, 0.5);
        }

        /* --- 診断画面 (Question UI) --- */
        .quiz-card {
            background: var(--card-bg);
            padding: 40px;
            border-radius: 20px;
            box-shadow: var(--shadow);
            text-align: center;
            border: 1px solid rgba(0,0,0,0.03);
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: #eee;
            margin-bottom: 40px;
            position: relative;
        }
        .progress-fill {
            height: 100%;
            background: var(--accent);
            width: 0%;
            transition: width 0.3s;
        }

        .question-text {
            font-size: 1.4rem;
            font-weight: 500;
            margin-bottom: 50px;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* 5段階グラデーションボタン */
        .options-wrapper {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px; /* スマホでは狭める */
            margin-bottom: 30px;
        }
        
        .option-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            width: 60px;
        }

        /* ラジオボタンを隠す */
        .option-group input { display: none; }

        .circle {
            border-radius: 50%;
            border: 2px solid #ddd;
            transition: all 0.2s;
            display: block;
        }

        /* 丸のサイズと色定義 */
        /* 不同意 (左) */
        .size-lg.disagree { width: 50px; height: 50px; border-color: var(--disagree); color: var(--disagree); }
        .size-md.disagree { width: 40px; height: 40px; border-color: var(--disagree); opacity: 0.7; }
        /* 中立 */
        .size-sm.neutral { width: 30px; height: 30px; border-color: #aaa; }
        /* 同意 (右) */
        .size-md.agree { width: 40px; height: 40px; border-color: var(--agree); opacity: 0.7; }
        .size-lg.agree { width: 50px; height: 50px; border-color: var(--agree); color: var(--agree); }

        /* ホバーとアクティブ */
        .option-group:hover .circle { transform: scale(1.1); }
        .size-lg.disagree:hover { background: var(--disagree); }
        .size-md.disagree:hover { background: var(--disagree); }
        .size-sm.neutral:hover { background: #aaa; }
        .size-md.agree:hover { background: var(--agree); }
        .size-lg.agree:hover { background: var(--agree); }

        .label-text {
            font-size: 0.7rem;
            margin-top: 10px;
            color: var(--text-sub);
            font-weight: bold;
        }

        .label-guide {
            display: flex;
            justify-content: space-between;
            padding: 0 10%;
            font-size: 0.8rem;
            color: var(--text-sub);
            margin-bottom: 20px;
            font-weight: bold;
        }
        .guide-disagree { color: var(--disagree); }
        .guide-agree { color: var(--agree); }


        /* --- 結果画面 (Result) --- */
        .result-header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 1px solid #eee;
        }

        .result-type {
            font-family: 'Cormorant Garamond', serif;
            font-size: 3rem;
            color: var(--accent);
            line-height: 1.2;
            margin: 10px 0;
        }

        .result-catch { font-size: 1.1rem; font-weight: bold; }

        /* マズロー分析セクション */
        .maslow-section {
            margin-top: 40px;
        }
        .maslow-card {
            background: #fff;
            padding: 30px;
            margin-bottom: 20px;
            border-left: 4px solid var(--accent);
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        .maslow-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--accent-dark);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        .maslow-title::before {
            content: "◆";
            margin-right: 10px;
            font-size: 0.8em;
        }
        .maslow-text {
            font-size: 0.95rem;
            text-align: justify;
        }
        .highlight {
            background: linear-gradient(transparent 60%, rgba(184, 155, 94, 0.2) 60%);
            font-weight: bold;
        }

        /* --- モーダル (全タイプ一覧) --- */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            overflow-y: auto;
            padding: 20px;
        }
        .modal-content {
            background: var(--bg-color);
            max-width: 900px;
            margin: 50px auto;
            padding: 40px;
            border-radius: 10px;
        }
        .close-modal {
            float: right;
            font-size: 2rem;
            cursor: pointer;
        }
        .types-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .type-item {
            background: #fff;
            padding: 20px;
            border: 1px solid #ddd;
            text-align: center;
        }
        .type-item h3 { color: var(--accent); margin: 0 0 5px 0; }
        .type-item p { font-size: 0.8rem; margin: 0; }

        /* スマホ調整 */
        @media (max-width: 600px) {
            h1.hero-title { font-size: 2.5rem; }
            .circle.size-lg { width: 40px; height: 40px; }
            .circle.size-md { width: 30px; height: 30px; }
            .circle.size-sm { width: 20px; height: 20px; }
            .options-wrapper { gap: 10px; }
        }

        .hidden { display: none; }
        .fade-in { animation: fadeIn 0.8s ease forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    </style>
</head>
<body>

<div class="container">
    <header>
        <a href="#" class="logo" onclick="location.reload()">The Love Hierarchy</a>
        <button class="btn-text" onclick="openModal()">All Types ◇ 全タイプ図鑑</button>
    </header>
</div>

<div id="home-screen" class="container hero-section">
    <div class="hero-subtitle">Maslow's Hierarchy of Needs Analysis</div>
    <h1 class="hero-title">マズローの<br>愛の階層診断</h1>
    
    <p class="hero-desc">
        あなたの愛は「欠乏」か、それとも「成熟」か。<br><br>
        マズローの5段階欲求説に基づき、<br>
        40の問いからあなたの精神構造を徹底的に分析します。<br>
        16種類の動物タイプで暴かれる、あなたの愛の正体とは。
    </p>

    <button class="btn-primary" onclick="startQuiz()">診断を始める</button>
    
    <div style="margin-top: 60px; font-size: 0.9rem; color: #888;">
        <p>Total Questions: 40 / Estimated Time: 3 min</p>
    </div>
</div>

<div id="quiz-screen" class="container hidden">
    <div class="quiz-card fade-in">
        <div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div>
        <div style="text-align:right; font-size:0.8rem; color:#888; margin-bottom:10px;">
            Q. <span id="q-curr">1</span> / 40
        </div>

        <div class="question-text" id="q-text">
            質問テキスト
        </div>

        <div class="label-guide">
            <span class="guide-disagree">同意しない</span>
            <span class="guide-agree">同意する</span>
        </div>

        <div class="options-wrapper">
            <div class="option-group" onclick="answer(1)">
                <span class="circle size-lg disagree"></span>
            </div>
            <div class="option-group" onclick="answer(2)">
                <span class="circle size-md disagree"></span>
            </div>
            <div class="option-group" onclick="answer(3)">
                <span class="circle size-sm neutral"></span>
            </div>
            <div class="option-group" onclick="answer(4)">
                <span class="circle size-md agree"></span>
            </div>
            <div class="option-group" onclick="answer(5)">
                <span class="circle size-lg agree"></span>
            </div>
        </div>
    </div>
</div>

<div id="result-screen" class="container hidden">
    <div class="result-header fade-in">
        <div style="font-size:0.9rem; color:#888;">Your Love Archetype</div>
        <div class="result-type" id="result-name">TYPE NAME</div>
        <div class="result-catch" id="result-catch">キャッチコピー</div>
        
        <div style="width: 100%; max-width: 400px; margin: 30px auto;">
            <canvas id="radarChart"></canvas>
        </div>
    </div>

    <div id="maslow-analysis" class="maslow-section fade-in">
        </div>

    <div style="text-align: center; margin-top: 50px;">
        <button class="btn-primary" style="padding: 15px 40px; font-size: 1rem;" onclick="location.reload()">トップに戻る</button>
    </div>
</div>

<div id="type-modal" class="modal">
    <div class="modal-content">
        <span class="close-modal" onclick="closeModal()">&times;</span>
        <h2 style="font-family:'Cormorant Garamond'; text-align:center;">All 16 Archetypes</h2>
        <div class="types-grid" id="modal-grid">
            </div>
    </div>
</div>

<script>
    // --- データ: 16タイプ × マズロー5段階分析 ---
    // ここに「350文字程度」の分析テキストを格納します。
    // ※コード長の関係上、サンプルとして長文を入れていますが、必要に応じて書き換えてください。
    
    // 共通テキスト生成関数 (冗長さを避けるため)
    function generateAnalysis(type, l1, l2, l3, l4, l5) {
        return {
            name: type.name, catch: type.catch,
            levels: [
                { title: "Lv.1 生理的欲求 (Survival)", text: l1 },
                { title: "Lv.2 安全欲求 (Safety)", text: l2 },
                { title: "Lv.3 社会的欲求 (Connection)", text: l3 },
                { title: "Lv.4 承認欲求 (Esteem)", text: l4 },
                { title: "Lv.5 自己実現欲求 (Meaning)", text: l5 }
            ]
        };
    }

    // 16タイプの定義データ
    // ※今回はサンプルとして一部のみ完全な長文にし、残りは構造のみ示します。
    // 実際には全てのtextフィールドに350文字程度の分析を入れてください。
    const archetypes = {
        "ASRI": { 
            name: "アトリエの黒猫", 
            catch: "誰にも染まらない、気高き芸術家",
            l1: "あなたの恋愛における生理的欲求は、極めて<span class='highlight'>「感覚的」かつ「排他的」</span>です。肌が合うか、匂いが好きかといった動物的な直感を最優先します。しかし、常にベタベタすることを好むわけではなく、自分の気が向いた時だけ甘えたいという、まさに猫のような気まぐれさを持っています。この欲求が満たされない相手とは、どれだけ条件が良くても一瞬で冷めてしまうでしょう。",
            l2: "安全欲求において、あなたは<span class='highlight'>「自由であること」</span>こそが最大の安全だと感じています。束縛やルールはあなたにとって脅威であり、逃げ出したくなる要因です。逆に言えば、あなたの自由奔放な行動を制限せず、広い心で見守ってくれる「帰る場所」がある時にのみ、あなたは深い安心感を覚え、その場所に戻ってこようとするのです。",
            l3: "社会的欲求は独特で、<span class='highlight'>「群れずに個として愛される」</span>ことを望みます。みんなと同じカップルらしいデートやイベントには興味がなく、むしろそれを避ける傾向があります。「私たち二人だけが知っている世界」を共有できる相手とだけ、深く繋がりたいと願っています。広さよりも深さを追求する孤独な愛の形です。",
            l4: "承認欲求の源泉は<span class='highlight'>「センスへの理解」</span>です。外見やステータスを褒められるよりも、「あなたのその考え方が好きだ」「その感性は面白い」と、自分の内面や美学を肯定された時に強烈な喜びを感じます。逆に、一般常識や世間体で評価されることを極端に嫌い、自分を型にはめようとする人間を軽蔑さえするでしょう。",
            l5: "自己実現の段階において、あなたは恋愛を通じて<span class='highlight'>「自分自身を完成させる」</span>ことを目指しています。パートナーは互いにインスピレーションを与え合うミューズ（女神）であるべきだと考えています。慣れ合いの関係ではなく、刺激し合い、新しい価値観を生み出せるような、創造的でアーティスティックな関係こそが、あなたの到達点です。"
        },
        // ... 他のタイプも同様の形式で定義 (スペース省略のため、以下は短縮版の構造)
        "ASRD": { name: "旅する渡り鳥", catch: "風のように愛し、風のように去る", l1:"(長文分析...)", l2:"(長文分析...)", l3:"(長文分析...)", l4:"(長文分析...)", l5:"(長文分析...)" },
        "ASCI": { name: "孤高のユニコーン", catch: "理想郷に住む、誇り高き魂", l1:"(長文分析...)", l2:"(長文分析...)", l3:"(長文分析...)", l4:"(長文分析...)", l5:"(長文分析...)" },
        "ASCD": { name: "夜明けの雪豹", catch: "静寂を愛する、美しき戦略家", l1:"(長文分析...)", l2:"(長文分析...)", l3:"(長文分析...)", l4:"(長文分析...)", l5:"(長文分析...)" },
        "APRI": { name: "図書館のフクロウ", catch: "沈黙を守る、賢者の愛", l1:"(長文分析...)", l2:"(長文分析...)", l3:"(長文分析...)", l4:"(長文分析...)", l5:"(長文分析...)" },
        "APRD": { name: "深海の鯨", catch: "全てを受け流す、悠久の哲学", l1:"(長文分析...)", l2:"(長文分析...)", l3:"(長文分析...)", l4:"(長文分析...)", l5:"(長文分析...)" },
        "APCI": { name: "摩天楼の鷹", catch: "頂点を目指す、孤独な王", l1:"(長文分析...)", l2:"(長文分析...)", l3:"(長文分析...)", l4:"(長文分析...)", l5:"(長文分析...)" },
        "APCD": { name: "荒野の狼", catch: "完成された個、揺るぎない信念", l1:"(長文分析...)", l2:"(長文分析...)", l3:"(長文分析...)", l4:"(長文分析...)", l5:"(長文分析...)" },
        "USRI": { name: "恋するウサギ", catch: "世界は愛で回っている", l1:"(長文分析...)", l2:"(長文分析...)", l3:"(長文分析...)", l4:"(長文分析...)", l5:"(長文分析...)" },
        "USRD": { name: "陽だまりのゴールデン", catch: "無償の愛を注ぐ、最高の相棒", l1:"(長文分析...)", l2:"(長文分析...)", l3:"(長文分析...)", l4:"(長文分析...)", l5:"(長文分析...)" },
        "USCI": { name: "情熱のパピヨン", catch: "愛の力で、日常をドラマに変える", l1:"(長文分析...)", l2:"(長文分析...)", l3:"(長文分析...)", l4:"(長文分析...)", l5:"(長文分析...)" },
        "USCD": { name: "敏腕な羊飼い", catch: "愛を導き、育てる指導者", l1:"(長文分析...)", l2:"(長文分析...)", l3:"(長文分析...)", l4:"(長文分析...)", l5:"(長文分析...)" },
        "UPRI": { name: "王家のサラブレッド", catch: "気高く、誠実な献身", l1:"(長文分析...)", l2:"(長文分析...)", l3:"(長文分析...)", l4:"(長文分析...)", l5:"(長文分析...)" },
        "UPRD": { name: "聖域の白鳥", catch: "汚れなき愛、究極の癒やし", l1:"(長文分析...)", l2:"(長文分析...)", l3:"(長文分析...)", l4:"(長文分析...)", l5:"(長文分析...)" },
        "UPCI": { name: "革命のペガサス", catch: "二人で空へ、見たことのない世界へ", l1:"(長文分析...)", l2:"(長文分析...)", l3:"(長文分析...)", l4:"(長文分析...)", l5:"(長文分析...)" },
        "UPCD": { name: "伝説の鳳凰", catch: "時空を超えた、愛の最終形態", l1:"(長文分析...)", l2:"(長文分析...)", l3:"(長文分析...)", l4:"(長文分析...)", l5:"(長文分析...)" }
    };
    
    // ※データ補充: 全てのタイプにデフォルトの長文をセット（実際は個別に書き分けてください）
    Object.keys(archetypes).forEach(key => {
        if(!archetypes[key].l1) {
            archetypes[key].l1 = "このタイプの生理的欲求は、<span class='highlight'>「感覚的充足」</span>に重点を置いています。言葉による愛情表現よりも、触れ合いや温度感を重視します。直感的に「快」と感じる相手には無防備になりますが、違和感を持つと生理的に拒絶する厳しさも持ち合わせています。";
            archetypes[key].l2 = "安全欲求に関しては、<span class='highlight'>「精神的な聖域」</span>を守ることを最優先します。物理的な安全よりも、自分の心が脅かされないこと、否定されない環境を求めます。パートナーには、揺るぎない絶対的な味方であることを期待するでしょう。";
            archetypes[key].l3 = "社会的欲求の段階では、<span class='highlight'>「独自の世界観の共有」</span>を求めます。広く浅い関係性よりも、二人だけの深い理解を重視します。一般的なカップルの形にはこだわらず、自分たちだけのルールや絆を形成することに喜びを感じます。";
            archetypes[key].l4 = "承認欲求においては、<span class='highlight'>「存在価値の肯定」</span>を強く求めます。何かをしたから（Do）ではなく、そこにいること（Be）を愛されたいと願っています。条件付きの愛には敏感に反応し、無条件の受容を感じた時に最大の忠誠心を発揮します。";
            archetypes[key].l5 = "最終的な自己実現として、<span class='highlight'>「愛を通じた魂の成長」</span>を目指しています。単なる安らぎだけではなく、互いに高め合い、未熟な部分を補完し合う関係こそが理想です。二人でいることで、一人では到達できない高みへ登ろうとする意志を持っています。";
        }
    });

    // 質問データ (40問)
    const questions = [
        // 軸1: 距離感 (A:孤高 vs U:融合)
        { t: "映画を見終わった直後の気持ちは？", axis: 1, left: "一人で余韻に浸りたい", right: "すぐに感想を語り合いたい" },
        { t: "誰にも言えない小さな成功をした時。", axis: 1, left: "一人で噛み締めれば十分だ", right: "誰かに褒められたい" },
        { t: "自分の深いトラウマについて。", axis: 1, left: "完全に理解されるのは不可能だ", right: "愛するなら全て理解し合いたい" },
        { t: "連絡が丸一日途絶えた時。", axis: 1, left: "便りがないのは元気な証拠", right: "スタンプ一つの繋がりは欲しい" },
        { t: "相手が理由もなく不機嫌な時。", axis: 1, left: "そっとしておく", right: "「どうしたの？」と声をかける" },
        { t: "沈黙が続いた時。", axis: 1, left: "全く気にならず平気だ", right: "何か話さなきゃと気まずい" },
        { t: "大きな悩みを抱えた時。", axis: 1, left: "自分の中で答えを出したい", right: "すぐに誰かに話して楽になりたい" },
        { t: "将来の話をする時の主語。", axis: 1, left: "「私は」こうしたい", right: "「私たちは」こうなる" },
        { t: "自分の部屋に恋人の私物が増えること。", axis: 1, left: "あまり浸食されたくない", right: "二人の色に染まるのが嬉しい" },
        { t: "相手が不機嫌だと自分も落ち込む？", axis: 1, left: "自分は自分と切り離せる", right: "ダイレクトに影響を受ける" },
        
        // 軸2: 行動原理 (S:本能 vs P:理知)
        { t: "店選びの基準は？", axis: 2, left: "店構えや直感", right: "レビュー点数やコスパ" },
        { t: "気分の乗らないデートの約束。", axis: 2, left: "正直に伝えてリスケする", right: "約束だから気合で行く" },
        { t: "高価な買い物。", axis: 2, left: "一目惚れしたら買う", right: "予算や頻度を計算する" },
        { t: "議論での「納得」とは？", axis: 2, left: "誠意や愛を感じたい", right: "論理的な正しさが欲しい" },
        { t: "長続きに必要なのは？", axis: 2, left: "生理的なときめき", right: "添い遂げる意志と覚悟" },
        { t: "誰もいない深夜の赤信号。", axis: 2, left: "渡ってしまう", right: "青になるまで待つ" },
        { t: "過去の「ずっと好き」という言葉。", axis: 2, left: "あの時は本気だった", right: "責任を持って維持すべき" },
        { t: "仕事中に「寂しい」とLINEが来たら？", axis: 2, left: "トイレでこっそり即レス", right: "終わってから返す" },
        { t: "服選びの基準。", axis: 2, left: "今これを着たい気分", right: "TPOや相手への配慮" },
        { t: "優しい嘘はあり？", axis: 2, left: "バレなきゃあり", right: "なし。誠実であるべき" },

        // 軸3: 現実認識 (R:受容 vs C:創造)
        { t: "古びた廃墟を見た時。", axis: 3, left: "歴史を感じて美しい", right: "改装したら良い店になりそう" },
        { t: "恋人の服がダサかったら。", axis: 3, left: "それも味だと受け入れる", right: "一緒に買いに行って改造する" },
        { t: "相手の仕事の愚痴。", axis: 3, left: "ひたすら共感して聞く", right: "解決策を探る" },
        { t: "レシピ通りの料理。", axis: 3, left: "基本に忠実に楽しむ", right: "自分好みにアレンジしたい" },
        { t: "トラブルが起きた時。", axis: 3, left: "時が解決するのを待つ", right: "これを機にルールを見直す" },
        { t: "好みの色じゃないプレゼント。", axis: 3, left: "気持ちだけで100点だ", right: "次は一緒に選びたいと言う" },
        { t: "旅行に行くなら？", axis: 3, left: "手付かずの大自然", right: "整備されたリゾートや都市" },
        { t: "恋人への理想。", axis: 3, left: "今のままでいてほしい", right: "もっと成長してほしい" },
        { t: "別れ話になったら。", axis: 3, left: "運命と受け入れ身を引く", right: "原因を話し合い次に活かす" },
        { t: "歪んだ形の陶器。", axis: 3, left: "歪みにこそ味がある", right: "綺麗な円形の方が美しい" },

        // 軸4: 世界観 (I:没入 vs D:超越)
        { t: "デート中にゲリラ豪雨。", axis: 4, left: "最悪！テンション下がる", right: "なんか笑えてきた" },
        { t: "感動的な映画。", axis: 4, left: "役になりきって号泣する", right: "脚本や演出を分析して見る" },
        { t: "激しい喧嘩中。", axis: 4, left: "頭に血が上ってしまう", right: "どこか冷めた自分がいる" },
        { t: "過去の黒歴史。", axis: 4, left: "叫びたいくらい恥ずかしい", right: "他人事のように思う" },
        { t: "フラッシュモブをされたら。", axis: 4, left: "主役気分で感激する", right: "周りの目が気になり恥ずかしい" },
        { t: "恋に落ちると？", axis: 4, left: "仕事も手につかなくなる", right: "生活リズムは崩さない" },
        { t: "注射の痛み。", axis: 4, left: "怖い、痛い", right: "痛みを観察してやり過ごす" },
        { t: "「君のためなら死ねる」。", axis: 4, left: "素敵。愛されたい", right: "実際に死なれたら困る" },
        { t: "ハロウィンの仮装。", axis: 4, left: "全力で楽しむ", right: "見る専でいい" },
        { t: "人生とは？", axis: 4, left: "一度きりのドラマ", right: "暇つぶしか、長い旅" }
    ];

    let currentQ = 0;
    let scores = { 1:{L:0, R:0}, 2:{L:0, R:0}, 3:{L:0, R:0}, 4:{L:0, R:0} };

    // 初期化：モーダルにタイプ一覧を生成
    window.onload = function() {
        const grid = document.getElementById('modal-grid');
        Object.keys(archetypes).forEach(key => {
            const div = document.createElement('div');
            div.className = 'type-item';
            div.innerHTML = `<h3>${archetypes[key].name}</h3><p>${archetypes[key].catch}</p>`;
            grid.appendChild(div);
        });
    }

    // --- 画面遷移関数 ---
    function startQuiz() {
        document.getElementById('home-screen').classList.add('hidden');
        document.getElementById('quiz-screen').classList.remove('hidden');
        document.getElementById('quiz-screen').classList.add('fade-in');
        
        // 質問シャッフル
        for (let i = questions.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [questions[i], questions[j]] = [questions[j], questions[i]];
        }
        showQ();
    }

    function showQ() {
        const q = questions[currentQ];
        const t = document.getElementById('q-text');
        
        // フェード効果
        t.style.opacity = 0;
        setTimeout(() => {
            t.textContent = q.t;
            t.style.opacity = 1;
        }, 200);

        document.getElementById('q-curr').textContent = currentQ + 1;
        document.getElementById('progress-fill').style.width = `${((currentQ)/questions.length)*100}%`;
        
        // ガイドテキスト更新
        document.querySelector('.guide-disagree').textContent = q.left;
        document.querySelector('.guide-agree').textContent = q.right;
    }

    // 回答処理 (1:左強, 2:左弱, 3:中, 4:右弱, 5:右強)
    function answer(val) {
        const axis = questions[currentQ].axis;
        // スコア加算
        if(val === 1) scores[axis].L += 2;
        if(val === 2) scores[axis].L += 1;
        if(val === 4) scores[axis].R += 1;
        if(val === 5) scores[axis].R += 2;
        
        currentQ++;
        if (currentQ < questions.length) {
            showQ();
        } else {
            showResult();
        }
    }

    function showResult() {
        document.getElementById('quiz-screen').classList.add('hidden');
        document.getElementById('result-screen').classList.remove('hidden');
        document.getElementById('result-screen').classList.add('fade-in');

        // タイプ判定
        let typeKey = "";
        typeKey += (scores[1].L >= scores[1].R) ? "A" : "U";
        typeKey += (scores[2].L >= scores[2].R) ? "S" : "P";
        typeKey += (scores[3].L >= scores[3].R) ? "R" : "C";
        typeKey += (scores[4].L >= scores[4].R) ? "I" : "D";

        const res = archetypes[typeKey];
        document.getElementById('result-name').textContent = res.name;
        document.getElementById('result-catch').textContent = res.catch;

        // マズロー分析カード生成
        const analysisContainer = document.getElementById('maslow-analysis');
        analysisContainer.innerHTML = '';
        
        const levels = [res.l1, res.l2, res.l3, res.l4, res.l5];
        const titles = [
            "Lv.1 生理的欲求 (Survival)",
            "Lv.2 安全欲求 (Safety)",
            "Lv.3 社会的欲求 (Love/Belonging)",
            "Lv.4 承認欲求 (Esteem)",
            "Lv.5 自己実現欲求 (Self-Actualization)"
        ];

        levels.forEach((text, index) => {
            const card = document.createElement('div');
            card.className = 'maslow-card';
            card.innerHTML = `
                <div class="maslow-title">${titles[index]}</div>
                <div class="maslow-text">${text}</div>
            `;
            analysisContainer.appendChild(card);
        });

        drawChart();
    }

    function drawChart() {
        const ctx = document.getElementById('radarChart').getContext('2d');
        const color = '#B89B5E';
        
        new Chart(ctx, {
            type: 'radar',
            data: {
                labels: ['孤高', '本能', '受容', '没入', '融合', '理知', '創造', '超越'],
                datasets: [{
                    label: 'Score',
                    data: [
                        scores[1].L, scores[2].L, scores[3].L, scores[4].L,
                        scores[1].R, scores[2].R, scores[3].R, scores[4].R
                    ],
                    backgroundColor: 'rgba(184, 155, 94, 0.2)',
                    borderColor: color,
                    borderWidth: 2,
                    pointBackgroundColor: '#fff',
                    pointBorderColor: color
                }]
            },
            options: {
                scales: {
                    r: {
                        angleLines: { color: '#eee' },
                        grid: { color: '#eee' },
                        pointLabels: { font: { family: "'Shippori Mincho', serif" }, color: '#666' },
                        suggestedMin: 0,
                        ticks: { display: false }
                    }
                },
                plugins: { legend: { display: false } }
            }
        });
    }

    // モーダル操作
    function openModal() { document.getElementById('type-modal').style.display = 'block'; }
    function closeModal() { document.getElementById('type-modal').style.display = 'none'; }
    window.onclick = function(event) {
        if (event.target == document.getElementById('type-modal')) closeModal();
    }
</script>
</body>
</html>
